<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ìŠ¤í‚¬ ê³„ì‚°ê¸°</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #121212;
      color: #ffffff;
      padding: 20px;
    }
    input[type="number"] {
      width: 80px;
      margin: 5px;
    }
    button {
      margin: 10px 0;
      padding: 5px 10px;
    }
    .section {
      margin-bottom: 30px;
      border-bottom: 1px solid #444;
      padding-bottom: 20px;
    }
  </style>
</head>
<body>
  <h1>ìŠ¤í‚¬ ê³„ì‚°ê¸°</h1>

  <!-- ì…ë ¥ì°½ -->
  <div class="section">
    <h2>ì…ë ¥ê°’</h2>
    <label>ê¸°ì´ˆê³µê²©ë ¥: <input id="baseAtk" type="number"></label>
    <label>ê¹¡ê³µ: <input id="flatAtk" type="number"></label>
    <label>ê³µê²©ë ¥%: <input id="atkPct" type="number"></label>
    <label>ê¸°ì´ˆìŠ¤í‚¬ë°ë¯¸ì§€%: <input id="baseSkillPct" type="number"></label>
    <label>ì¶”ê°€ìŠ¤í‚¬ë°ë¯¸ì§€%: <input id="addSkillPct" type="number"></label>
    <label>ì¹˜í™•%: <input id="critChance" type="number"></label>
    <label>ì¹˜ëª…íƒ€í”¼í•´%: <input id="critDmg" type="number"></label>
    <label>ì €ì£¼%: <input id="curse" type="number"></label>
    <label>ê°ì „%: <input id="shock" type="number"></label>
    <label>ì¶”ê°€í”¼í•´%: <input id="extraDmg" type="number"></label>
    <label>ì ì¤‘ì‹œ í”¼í•´: <input id="onHitDmg" type="number"></label>
    <label>ê¸°ë³¸ ê¸°ìˆ  í”¼í•´ëŸ‰ ì¦ê°€%: <input id="basicSkillBoost" type="number"></label>
  </div>

  <!-- ê²°ê³¼ -->
  <div class="section">
    <h2>ê²°ê³¼</h2>
    <button onclick="calculate()">ê³„ì‚°</button>
    <p>ğŸŸ  <strong>ìŠ¤í‚¬í”¼í•´:</strong> <span id="skillResult">-</span></p>
    <p>ğŸŸ¡ <strong>ê¸°ë³¸ ê¸°ìˆ  í”¼í•´:</strong> <span id="basicResult">-</span></p>
    <button onclick="saveResult()">í˜„ì¬ ê°’ ì €ì¥</button>
    <p>ğŸŸ¢ <strong>ì €ì¥ëœ ê°’:</strong> <span id="savedValue">ì—†ìŒ</span></p>
    <p>ğŸ”µ <strong>í˜„ì¬ íš¨ìœ¨ (ì¦ê°€ìœ¨):</strong> <span id="efficiency">-</span></p>
  </div>

  <script>
    function getValue(id) {
      const val = parseFloat(document.getElementById(id).value);
      return isNaN(val) ? null : val;
    }

    function calculate() {
      const baseAtk = getValue("baseAtk") ?? 0;
      const flatAtk = getValue("flatAtk") ?? 0;
      const atkPct = (getValue("atkPct") ?? 0) / 100;
      const baseSkillPct = (getValue("baseSkillPct") ?? 0) / 100;
      const addSkillPct = (getValue("addSkillPct") ?? 0) / 100;
      const critChance = (getValue("critChance") ?? 0) / 100;
      const critDmg = (getValue("critDmg") ?? 0) / 100;
      const curse = (getValue("curse") ?? 0) / 100;
      const shock = (getValue("shock") ?? 0) / 100;
      const extraDmg = (getValue("extraDmg") ?? 0) / 100;
      const onHitDmg = getValue("onHitDmg") ?? 0;
      const basicSkillBoost = (getValue("basicSkillBoost") ?? 0) / 100;

      const atkCalc = (baseAtk + flatAtk) * (1 + atkPct);
      const skillDmg = atkCalc * (baseSkillPct + addSkillPct) * (1 + critChance) * (2 + critDmg);
      const totalMultiplier = 1.2 * (1 + curse) * (1 + shock) * (1 + extraDmg);
      const finalSkill = skillDmg * totalMultiplier + onHitDmg;

      const basicSkill = skillDmg * (1 + basicSkillBoost) * totalMultiplier + onHitDmg;

      document.getElementById("skillResult").textContent = Math.round(finalSkill);
      document.getElementById("basicResult").textContent = Math.round(basicSkill);

      // íš¨ìœ¨ ê³„ì‚°
      const saved = parseFloat(localStorage.getItem("savedValue"));
      if (!isNaN(saved) && saved > 0) {
        const efficiency = finalSkill / saved;
        document.getElementById("efficiency").textContent = efficiency.toFixed(2) + "ë°°";
      } else {
        document.getElementById("efficiency").textContent = "-";
      }
    }

    function saveResult() {
      const val = document.getElementById("skillResult").textContent;
      if (!isNaN(val)) {
        localStorage.setItem("savedValue", val);
        document.getElementById("savedValue").textContent = val;
        calculate(); // ë‹¤ì‹œ ê³„ì‚°í•´ì„œ íš¨ìœ¨ ë°˜ì˜
      }
    }

    // ì²˜ìŒ ë¡œë”© ì‹œ ì €ì¥ê°’ ë¶ˆëŸ¬ì˜¤ê¸°
    window.onload = () => {
      const saved = localStorage.getItem("savedValue");
      if (saved) {
        document.getElementById("savedValue").textContent = saved;
      }
    };
  </script>
</body>
</html>
